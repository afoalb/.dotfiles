#!/bin/bash

# Minimalist SketchyBar configuration
# Clean, distraction-free status bar

PLUGIN_DIR="$CONFIG_DIR/plugins"

# -------------
# Bar appearance
# -------------
sketchybar --bar \
    position=top \
    height=28 \
    color=0xff1a1b26 \
    border_color=0xff2a2b3d \
    border_width=0 \
    shadow=off \
    padding_left=12 \
    padding_right=12 \
    margin=0 \
    y_offset=0 \
    corner_radius=0

# -------------
# Default item settings
# -------------
default=(
    padding_left=6
    padding_right=6
    icon.font="Hack Nerd Font:Bold:14.0"
    icon.color=0xffa9b1d6
    icon.padding_left=4
    icon.padding_right=4
    label.font="Hack Nerd Font:Regular:13.0"
    label.color=0xffc0caf5
    label.padding_left=4
    label.padding_right=4
    background.height=24
    background.corner_radius=4
)

sketchybar --default "${default[@]}"

# -------------
# LEFT: Workspace indicators
# -------------
for i in 1 2 3 4 5
do
    space=(
        space="$i"
        icon="$i"
        icon.font="Hack Nerd Font:Bold:12.0"
        icon.color=0xff565f89
        icon.highlight_color=0xff7aa2f7
        icon.padding_left=8
        icon.padding_right=8
        label.drawing=off
        background.color=0x00000000
        background.drawing=off
        script="$PLUGIN_DIR/space.sh"
        click_script="yabai -m space --focus $i"
    )
    sketchybar --add space space."$i" left --set space."$i" "${space[@]}"
done

# Separator
sketchybar --add item separator left \
           --set separator icon="â”‚" \
                          icon.color=0xff3b4261 \
                          icon.padding_left=4 \
                          icon.padding_right=4 \
                          label.drawing=off \
                          background.drawing=off

# Current application
sketchybar --add item front_app left \
           --set front_app icon.drawing=off \
                          label.color=0xff7dcfff \
                          label.font="Hack Nerd Font:Bold:13.0" \
                          script="$PLUGIN_DIR/front_app.sh" \
           --subscribe front_app front_app_switched

# Git branch (shows when in terminal/editor)
sketchybar --add item git_branch left \
           --set git_branch icon.drawing=off \
                           label.color=0xffbb9af7 \
                           label.font="Hack Nerd Font:Regular:12.0" \
                           drawing=off \
                           script="$PLUGIN_DIR/git_branch.sh" \
           --subscribe git_branch front_app_switched

# -------------
# RIGHT: Battery then Clock (rightmost)
# -------------
# Items added to "right" appear in reverse order (last added = rightmost)

# Clock (added first = rightmost)
sketchybar --add item clock right \
           --set clock update_freq=30 \
                      icon.drawing=off \
                      label.font="Hack Nerd Font:Regular:13.0" \
                      label.color=0xffa9b1d6 \
                      script="$PLUGIN_DIR/clock.sh"

# Battery (added second = left of clock)
sketchybar --add item battery right \
           --set battery update_freq=60 \
                        icon.drawing=off \
                        label.font="Hack Nerd Font:Regular:12.0" \
                        label.color=0xff9ece6a \
                        script="$PLUGIN_DIR/battery.sh" \
           --subscribe battery system_woke power_source_change

# -------------
# Initialise
# -------------
sketchybar --update
